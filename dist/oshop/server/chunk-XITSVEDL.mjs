import './polyfills.server.mjs';
import{a as A}from"./chunk-E34XWX4I.mjs";import{a as T,d as j,e as P,f as W,g as B,h as k,o as q,r as D}from"./chunk-UU6RMWTV.mjs";import{C as N,F as R,J as F,f as M,h as V,k as O,v as E}from"./chunk-DCBHLGG3.mjs";import{$ as w,Cc as L,Ob as d,Pb as o,Qb as s,Yb as h,bb as a,bc as _,cc as l,ea as C,ka as g,la as u,mc as y,nb as p,qc as c,sc as b,tb as I,uc as U,vc as x,wc as S,zb as f}from"./chunk-RSKEQSSP.mjs";import"./chunk-S6KH3LOX.mjs";var v=class i{http=C(E);baseUrl=`${F.apiUrl}/Users`;getUsers(){return this.http.get(this.baseUrl)}getUserById(t){return this.http.get(`${this.baseUrl}/${t}`)}createUser(t){return this.http.post(this.baseUrl,t)}updateUser(t,e){return this.http.put(`${this.baseUrl}/${t}`,e)}deleteUser(t){return this.http.delete(`${this.baseUrl}/${t}`)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})};var z=(i,t)=>({"alert-success":i,"alert-danger":t});function J(i,t){if(i&1&&(o(0,"div",11),c(1),s()),i&2){let e=l(2);d("ngClass",L(2,z,e.localLoggedIn,!e.localLoggedIn)),a(),b(" ",e.loginMessage," ")}}function K(i,t){if(i&1){let e=h();o(0,"div")(1,"div",2)(2,"form",3,0),_("ngSubmit",function(){g(e);let r=l();return u(r.login())}),o(4,"div",4)(5,"label",5),c(6,"Username"),s(),o(7,"input",6),S("ngModelChange",function(r){g(e);let m=l();return x(m.username,r)||(m.username=r),u(r)}),s()(),o(8,"div",4)(9,"label",5),c(10,"Password"),s(),o(11,"input",7),S("ngModelChange",function(r){g(e);let m=l();return x(m.password,r)||(m.password=r),u(r)}),s()(),o(12,"div",8)(13,"button",9),c(14,"Login"),s()()(),f(15,J,2,5,"div",10),s()()}if(i&2){let e=y(3),n=l();a(7),U("ngModel",n.username),a(4),U("ngModel",n.password),a(2),d("disabled",e.invalid),a(2),d("ngIf",n.loginMessage)}}function Q(i,t){if(i&1){let e=h();o(0,"div")(1,"div",12),c(2),s(),o(3,"button",13),_("click",function(){g(e);let r=l();return u(r.logout())}),c(4,"Log Out"),s()()}if(i&2){let e=l();a(2),b("Logged in as ",e.username)}}var $=class i{constructor(t,e,n,r){this.authService=t;this.router=e;this.activateRoute=n;this.userService=r;this.returnUrl=this.activateRoute.snapshot.queryParamMap.get("returnUrl")||"/"}username="admin";password="admin321";localLoggedIn=!1;loginMessage="";users=[];returnUrl="/";ngOnInit(){this.userService.getUsers().subscribe(t=>{this.users=t,this.authService.isAuthenticated()&&this.router.navigateByUrl(this.returnUrl)})}login(){let t=this.users.find(e=>e.username===this.username&&e.password===this.password);t?(this.localLoggedIn=!0,this.loginMessage="Login successful",this.authService.login(t),this.router.navigateByUrl(this.returnUrl)):(this.localLoggedIn=!1,this.loginMessage="Invalid username or password",this.authService.logout())}logout(){this.localLoggedIn=!1,this.username="",this.password="",this.loginMessage="",this.authService.logout()}static \u0275fac=function(e){return new(e||i)(p(A),p(R),p(N),p(v))};static \u0275cmp=I({type:i,selectors:[["app-login"]],decls:4,vars:2,consts:[["loginForm","ngForm"],[4,"ngIf"],[1,"card","p-3",2,"max-width","420px"],["novalidate","",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","username","required","","placeholder","admin","value","admin",1,"form-control",3,"ngModelChange","ngModel"],["name","password","type","password","required","","placeholder","admin321","value","admin",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","mt-3 alert",3,"ngClass",4,"ngIf"],[1,"mt-3","alert",3,"ngClass"],[1,"alert","alert-success"],[1,"btn","btn-secondary",3,"click"]],template:function(e,n){e&1&&(o(0,"h2"),c(1,"Login"),s(),f(2,K,16,4,"div",1)(3,Q,5,1,"div",1)),e&2&&(a(2),d("ngIf",!n.localLoggedIn),a(),d("ngIf",n.localLoggedIn))},dependencies:[O,M,V,D,k,T,j,P,q,B,W],styles:["h2[_ngcontent-%COMP%]{color:#333}"]})};export{$ as Login};
