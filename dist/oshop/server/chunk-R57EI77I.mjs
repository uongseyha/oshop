import './polyfills.server.mjs';
import{K as ie,S as re}from"./chunk-AHTDKOLG.mjs";import{a as q,b as ee}from"./chunk-ARWO4DGV.mjs";import{a as te}from"./chunk-SANJTULJ.mjs";import{h as $}from"./chunk-TOR6ZFJF.mjs";import"./chunk-PTM5PHSC.mjs";import{a as A,d as U,e as L,f as j,g as B,h as k,i as G,k as z,l as H,m as J,n as K,o as Q,p as X,q as Y,r as Z}from"./chunk-BWIQO4HK.mjs";import{C as O,F as W,g as N,h as R,k as D}from"./chunk-WGIOOPUP.mjs";import{H as C,Jb as F,Kb as M,Ob as c,Pb as r,Qb as o,Rb as T,Vc as V,Yb as I,bb as l,bc as x,cc as _,ka as f,la as v,mc as p,nb as g,oc as h,qc as m,sc as E,tb as w,uc as S,vc as P,wc as b,zb as u}from"./chunk-RSKEQSSP.mjs";import"./chunk-S6KH3LOX.mjs";function ne(t,i){t&1&&(r(0,"small"),m(1,"Title is required"),o())}function ae(t,i){t&1&&(r(0,"small"),m(1," Title must be at least 3 characters "),o())}function le(t,i){if(t&1&&(r(0,"div",21),u(1,ne,2,0,"small",22)(2,ae,2,0,"small",22),o()),t&2){_();let e=p(8);l(),c("ngIf",e.errors==null?null:e.errors.required),l(),c("ngIf",e.errors==null?null:e.errors.minlength)}}function de(t,i){t&1&&(r(0,"small"),m(1,"Price is required"),o())}function ce(t,i){t&1&&(r(0,"small"),m(1,"Price must be greater than 0"),o())}function me(t,i){if(t&1&&(r(0,"div",21),u(1,de,2,0,"small",22)(2,ce,2,0,"small",22),o()),t&2){_();let e=p(14);l(),c("ngIf",e.errors==null?null:e.errors.required),l(),c("ngIf",e.errors==null?null:e.errors.min)}}function se(t,i){if(t&1&&(r(0,"option",23),m(1),o()),t&2){let e=i.$implicit;c("value",e.id),l(),E(" ",e.description," ")}}function ue(t,i){t&1&&(r(0,"div",21)(1,"small"),m(2,"Category is required"),o()())}function pe(t,i){t&1&&(r(0,"small"),m(1,"Image URL is required"),o())}function ge(t,i){t&1&&(r(0,"small"),m(1," Enter a valid URL (http/https) "),o())}function fe(t,i){if(t&1&&(r(0,"div",21),u(1,pe,2,0,"small",22)(2,ge,2,0,"small",22),o()),t&2){_();let e=p(29);l(),c("ngIf",e.errors==null?null:e.errors.required),l(),c("ngIf",e.errors==null?null:e.errors.pattern)}}function ve(t,i){if(t&1&&(r(0,"button",24),m(1," Save "),o()),t&2){_();let e=p(3);c("disabled",e.invalid)}}function _e(t,i){if(t&1){let e=I();r(0,"button",25),x("click",function(){f(e);let d=_();return v(d.deleteProduct(d.product.id))}),m(1," Delete "),o()}}function ye(t,i){if(t&1&&(r(0,"div",20),T(1,"app-product-card",26),o()),t&2){let e=_();l(),c("product",e.product)("showActions",!1)}}var oe=class t{constructor(i,e,a,d,s,n,y){this.categoryService=i;this.productService=e;this.router=a;this.activateRoute=d;this.cdr=s;this.toastr=n;this.dialog=y;this.loadCategories(),this.productId=this.activateRoute.snapshot.paramMap.get("id"),this.loadProductById(this.productId)}categories=[];product={id:0,title:"",price:0,categoryId:0,imageUrl:""};productId;ngOnInit(){}loadCategories(){this.categoryService.getCategories().pipe(C(1)).subscribe({next:i=>{this.categories=i},error:i=>{console.error(i)}})}saveProduct(i){if(!i.valid){i.control.markAllAsTouched();return}let e=i.value;(this.productId?this.productService.updateProduct(Number(this.productId),e):this.productService.createProduct(e)).subscribe({next:()=>{this.router.navigate(["/admin/products"])},error:d=>{this.toastr.error("Something went wrong! Please try again.")}})}loadProductById(i){i!=null&&this.productService.getProductById(Number(i)).pipe(C(1)).subscribe({next:e=>{this.product=e,this.cdr&&this.cdr.detectChanges()},error:e=>{console.error(e)}})}deleteProduct(i){this.dialog.open(re,{width:"350px",data:{message:"Are you sure you want to delete this product?"}}).afterClosed().subscribe(a=>{a&&this.productService.deleteProduct(i).subscribe({next:()=>this.router.navigate(["/admin/products"]),error:d=>console.error(d)})})}ngOnDestroy(){}static \u0275fac=function(e){return new(e||t)(g(q),g(te),g(W),g(O),g(V),g($),g(ie))};static \u0275cmp=w({type:t,selectors:[["app-product-form"]],decls:35,vars:20,consts:[["productForm","ngForm"],["title","ngModel"],["price","ngModel"],["categoryId","ngModel"],["imageUrl","ngModel"],[1,"row"],[1,"col-md-6"],["novalidate","",1,"p-3",3,"ngSubmit"],[1,"input-group","mb-3"],[1,"input-group-text"],["type","text","name","title","required","","minlength","3",1,"form-control",3,"ngModelChange","ngModel"],["class","text-danger",4,"ngIf"],["type","number","name","price","required","","min","0.01","step","0.01",1,"form-control",3,"ngModelChange","ngModel"],["name","categoryId","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","url","name","imageUrl","pattern","https?://.+",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2","mt-4"],["type","submit","class","btn btn-primary flex-grow-1",3,"disabled",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],[1,"col-md-3"],[1,"text-danger"],[4,"ngIf"],[3,"value"],["type","submit",1,"btn","btn-primary","flex-grow-1",3,"disabled"],["type","button",1,"btn","btn-danger",3,"click"],[3,"product","showActions"]],template:function(e,a){if(e&1){let d=I();r(0,"div",5)(1,"div",6)(2,"form",7,0),x("ngSubmit",function(){f(d);let n=p(3);return v(a.saveProduct(n))}),r(4,"div",8)(5,"span",9),m(6,"Title"),o(),r(7,"input",10,1),b("ngModelChange",function(n){return f(d),P(a.product.title,n)||(a.product.title=n),v(n)}),o()(),u(9,le,3,2,"div",11),r(10,"div",8)(11,"span",9),m(12,"$"),o(),r(13,"input",12,2),b("ngModelChange",function(n){return f(d),P(a.product.price,n)||(a.product.price=n),v(n)}),o()(),u(15,me,3,2,"div",11),r(16,"div",8)(17,"label",9),m(18,"Category"),o(),r(19,"select",13,3),b("ngModelChange",function(n){return f(d),P(a.product.categoryId,n)||(a.product.categoryId=n),v(n)}),r(21,"option",14),m(22,"Select category"),o(),u(23,se,2,2,"option",15),o()(),u(24,ue,3,0,"div",11),r(25,"div",8)(26,"span",9),m(27,"Image URL"),o(),r(28,"input",16,4),b("ngModelChange",function(n){return f(d),P(a.product.imageUrl,n)||(a.product.imageUrl=n),v(n)}),o()(),u(30,fe,3,2,"div",11),r(31,"div",17),u(32,ve,2,1,"button",18)(33,_e,2,0,"button",19),o()()(),F(34,ye,2,2,"div",20),o()}if(e&2){let d=p(8),s=p(14),n=p(20),y=p(29);l(7),h("is-invalid",d.invalid&&d.touched),S("ngModel",a.product.title),l(2),c("ngIf",d.invalid&&d.touched),l(4),h("is-invalid",s.invalid&&s.touched),S("ngModel",a.product.price),l(2),c("ngIf",s.invalid&&s.touched),l(4),h("is-invalid",n.invalid&&n.touched),S("ngModel",a.product.categoryId),l(4),c("ngForOf",a.categories),l(),c("ngIf",n.invalid&&n.touched),l(4),h("is-invalid",y.invalid&&y.touched),S("ngModel",a.product.imageUrl),l(2),c("ngIf",y.invalid&&y.touched),l(2),c("ngIf",!a.product.isProtected),l(),c("ngIf",a.product.id&&!a.product.isProtected),l(),M(d.valid?34:-1)}},dependencies:[D,N,R,Z,k,H,J,A,G,z,U,L,Q,X,Y,K,B,j,ee],encapsulation:2})};export{oe as ProductForm};
